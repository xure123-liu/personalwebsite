# 🌐 网站完整部署指南（适合无编程经验）

## 📋 部署前准备

### ✅ 确认事项
- [x] 代码已提交到 Gitee
- [x] 前后端代码已准备好
- [x] 环境变量配置已就绪

---

## 🎯 部署方案选择

### 方案一：使用 Render（推荐，最简单）
**优点**：
- ✅ 完全免费（个人使用足够）
- ✅ 部署最简单（连接仓库自动部署）
- ✅ 自动 HTTPS
- ✅ 支持自动更新

**缺点**：
- ⚠️ Render 不支持 Gitee，需要先同步到 GitHub

### 方案二：使用 Railway（支持 Gitee）
**优点**：
- ✅ 支持 Gitee
- ✅ 免费额度充足
- ✅ 部署简单

**缺点**：
- ⚠️ 需要信用卡验证（但不会扣费）

---

## 🚀 方案一：使用 Render 部署（推荐）

### 第一步：将代码同步到 GitHub

由于 Render 不支持 Gitee，我们需要先将代码同步到 GitHub。

#### 1.1 创建 GitHub 账号
1. 访问：https://github.com
2. 点击右上角 "Sign up" 注册账号
3. 验证邮箱

#### 1.2 创建新仓库
1. 登录 GitHub
2. 点击右上角 "+" → "New repository"
3. 填写信息：
   - **Repository name**: `personal-web`（或自定义）
   - **Description**: 个人作品集网站
   - **Visibility**: 选择 "Public"（免费）或 "Private"（需要付费）
   - ⚠️ **不要**勾选 "Initialize this repository with a README"
4. 点击 "Create repository"

#### 1.3 将 Gitee 代码推送到 GitHub
在终端执行以下命令（我已经帮你准备好了）：

```bash
# 进入项目目录
cd "/Users/liuyou/Downloads/斜杠/个人web网站"

# 添加 GitHub 远程仓库（替换 YOUR_USERNAME 为你的 GitHub 用户名）
git remote add github https://github.com/YOUR_USERNAME/personal-web.git

# 推送到 GitHub
git push github main
```

**注意**：需要输入 GitHub 用户名和密码（或 Personal Access Token）

#### 1.4 生成 GitHub Personal Access Token（如果推送失败）
1. 访问：https://github.com/settings/tokens
2. 点击 "Generate new token" → "Generate new token (classic)"
3. 填写信息：
   - **Note**: `部署网站用`
   - **Expiration**: 选择 "No expiration" 或自定义
   - **Select scopes**: 勾选 `repo`（全部权限）
4. 点击 "Generate token"
5. **复制生成的 token**（只显示一次，务必保存）
6. 推送时，密码处输入这个 token

---

### 第二步：部署后端服务

#### 2.1 注册 Render 账号
1. 访问：https://render.com
2. 点击 "Get Started for Free"
3. 选择 "Sign up with GitHub"（使用 GitHub 账号登录）
4. 授权 Render 访问你的 GitHub 仓库

#### 2.2 创建后端服务
1. 登录 Render 后，点击 "New" → "Web Service"
2. 连接仓库：
   - 选择 "Connect account"（如果还没连接 GitHub）
   - 选择你的仓库：`personal-web`
3. 配置服务：
   - **Name**: `portfolio-backend`（自定义名称）
   - **Region**: 选择离你最近的区域（如 `Singapore`）
   - **Branch**: `main`
   - **Root Directory**: `portfolio-backend` ⚠️ **重要**
   - **Runtime**: `Node`
   - **Build Command**: `npm install`
   - **Start Command**: `node server.js`
4. 点击 "Advanced" → 添加环境变量：
   ```
   NODE_ENV = production
   JWT_SECRET = 你的强密码（至少32个字符，包含字母数字特殊字符）
   ```
   **生成强密码的方法**：
   - 访问：https://www.random.org/strings/
   - 设置：长度 32，字符集选择 "Alphanumeric + Special"
   - 复制生成的密码
5. 点击 "Create Web Service"
6. 等待部署完成（约 2-5 分钟）
7. **记录后端 URL**：例如 `https://portfolio-backend-xxx.onrender.com`

---

### 第三步：部署前端服务

#### 3.1 创建前端静态网站
1. 在 Render 首页，点击 "New" → "Static Site"
2. 连接仓库：
   - 选择同一个仓库：`personal-web`
3. 配置服务：
   - **Name**: `portfolio-frontend`（自定义名称）
   - **Branch**: `main`
   - **Root Directory**: `portfolio-frontend` ⚠️ **重要**
   - **Build Command**: `npm install && npm run build`
   - **Publish Directory**: `dist` ⚠️ **重要**
4. 添加环境变量：
   ```
   VITE_API_URL = https://portfolio-backend-xxx.onrender.com
   ```
   ⚠️ **注意**：
   - 使用第二步记录的后端 URL
   - **不要**包含 `/api` 后缀
   - 确保是 `https://` 开头
5. 点击 "Create Static Site"
6. 等待部署完成（约 3-5 分钟）
7. **记录前端 URL**：例如 `https://portfolio-frontend-xxx.onrender.com`

---

### 第四步：测试部署

#### 4.1 测试前端网站
1. 访问前端 URL（例如：`https://portfolio-frontend-xxx.onrender.com`）
2. 检查：
   - ✅ 页面是否正常加载
   - ✅ 图片是否显示
   - ✅ 导航是否正常

#### 4.2 测试后台管理系统
1. 访问：`https://portfolio-frontend-xxx.onrender.com/admin`
2. 使用默认账号登录：
   - **用户名**: `Liuxueyou`
   - **密码**: `5203013009LXYdsg`
3. 检查：
   - ✅ 登录是否成功
   - ✅ 能否查看数据
   - ✅ 能否上传文件

#### 4.3 修改默认密码（重要安全步骤）
1. 登录后台管理系统
2. 由于当前系统没有修改密码功能，你需要：
   - 在 Render 后端服务的 "Environment" 中，添加新的环境变量来重置密码
   - 或者联系我帮你添加修改密码功能

---

## 🚀 方案二：使用 Railway 部署（支持 Gitee）

### 第一步：注册 Railway
1. 访问：https://railway.app
2. 点击 "Start a New Project"
3. 选择 "Login with GitHub" 或 "Login with Email"
4. ⚠️ 需要验证信用卡（不会扣费，只是验证）

### 第二步：部署后端
1. 点击 "New Project" → "Deploy from GitHub repo"
2. 如果使用 Gitee：
   - 点击 "Configure GitHub App"
   - 或者选择 "Deploy from GitHub repo" 后，在设置中连接 Gitee
3. 选择仓库：`personal-web`
4. 设置 Root Directory：`portfolio-backend`
5. 添加环境变量：
   ```
   NODE_ENV=production
   JWT_SECRET=你的强密码
   ```
6. Railway 会自动检测 Node.js 并部署
7. 记录生成的后端 URL

### 第三步：部署前端
1. 创建新服务：点击 "New" → "Static Site"
2. 连接仓库：`personal-web`
3. 设置：
   - Root Directory: `portfolio-frontend`
   - Build Command: `npm install && npm run build`
   - Output Directory: `dist`
4. 添加环境变量：
   ```
   VITE_API_URL=后端URL
   ```
5. 记录生成的前端 URL

---

## 🔒 安全配置（重要）

### 1. 修改 JWT Secret
在部署时，务必设置一个强密码作为 `JWT_SECRET`：
- 至少 32 个字符
- 包含字母、数字、特殊字符
- 不要使用默认值

### 2. 修改默认账号密码
当前默认账号：
- 用户名：`Liuxueyou`
- 密码：`5203013009LXYdsg`

**建议**：部署后立即修改密码（需要添加修改密码功能）

### 3. 限制后台访问（可选）
如果需要更严格的安全控制，可以：
- 使用 IP 白名单
- 添加二次验证
- 限制登录尝试次数

---

## 📝 部署后维护

### 自动更新
- **Render**：每次推送到 GitHub 的 `main` 分支，会自动重新部署
- **Railway**：同样支持自动部署

### 手动更新
如果需要手动触发部署：
1. 在 Render/Railway 控制台
2. 找到对应的服务
3. 点击 "Manual Deploy" → "Deploy latest commit"

### 查看日志
如果出现问题：
1. 在服务控制台点击 "Logs"
2. 查看错误信息
3. 根据错误信息排查问题

---

## 🆘 常见问题

### 问题1：前端无法连接后端
**原因**：环境变量配置错误
**解决**：
1. 检查 `VITE_API_URL` 是否正确
2. 确保后端 URL 是 `https://` 开头
3. 确保不包含 `/api` 后缀
4. 重新部署前端

### 问题2：图片不显示
**原因**：图片路径或后端服务问题
**解决**：
1. 检查后端服务是否正常运行
2. 检查图片 URL 是否正确
3. 查看后端日志

### 问题3：登录失败
**原因**：JWT_SECRET 未设置或账号密码错误
**解决**：
1. 检查后端环境变量 `JWT_SECRET` 是否设置
2. 确认账号密码正确
3. 查看后端日志

### 问题4：服务休眠（Render 免费版）
**原因**：免费服务 15 分钟无活动后会休眠
**解决**：
- 首次访问需要等待几秒唤醒
- 如果经常使用，可以考虑付费计划（$7/月）

### 问题5：GitHub 推送失败
**原因**：认证问题
**解决**：
1. 使用 Personal Access Token 代替密码
2. 确保 token 有 `repo` 权限
3. 检查 token 是否过期

---

## ✅ 部署检查清单

### 部署前
- [ ] 代码已提交到 Gitee
- [ ] 已创建 GitHub 账号和仓库（如果使用 Render）
- [ ] 已生成 GitHub Personal Access Token（如果需要）

### 后端部署
- [ ] 后端服务已创建
- [ ] Root Directory 设置为 `portfolio-backend`
- [ ] 环境变量已设置（NODE_ENV, JWT_SECRET）
- [ ] 部署成功，记录后端 URL

### 前端部署
- [ ] 前端服务已创建
- [ ] Root Directory 设置为 `portfolio-frontend`
- [ ] Publish Directory 设置为 `dist`
- [ ] 环境变量已设置（VITE_API_URL = 后端URL）
- [ ] 部署成功，记录前端 URL

### 测试
- [ ] 前端网站可以正常访问
- [ ] 图片可以正常显示
- [ ] 后台管理系统可以登录
- [ ] 可以上传文件
- [ ] 可以修改数据

### 安全
- [ ] JWT_SECRET 已设置为强密码
- [ ] 默认密码已修改（或计划修改）
- [ ] HTTPS 正常工作

---

## 🎉 部署完成

部署完成后，你的网站就可以通过公网访问了！

- **前端网站**：`https://portfolio-frontend-xxx.onrender.com`
- **后台管理**：`https://portfolio-frontend-xxx.onrender.com/admin`

**重要提醒**：
1. 保存好你的登录信息
2. 定期备份数据库（如果需要）
3. 如果遇到问题，查看服务日志

---

## 📞 需要帮助？

如果部署过程中遇到问题：
1. 查看服务日志
2. 检查环境变量配置
3. 确认代码已正确提交
4. 联系我获取帮助

