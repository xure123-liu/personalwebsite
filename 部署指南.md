# 网站部署指南

## 📋 部署方案：使用 Render（推荐）

Render 是一个简单易用的云平台，提供免费额度，适合部署全栈应用。

### 为什么选择 Render？
- ✅ **完全免费**（免费额度足够个人使用）
- ✅ **部署简单**（连接 GitHub 自动部署）
- ✅ **支持 Node.js 和静态网站**
- ✅ **自动 HTTPS**
- ✅ **持久化存储**（数据库和文件）

---

## 🚀 部署步骤

### 第一步：准备代码

1. **确保代码已提交到 GitHub**
   ```bash
   git add .
   git commit -m "准备部署"
   git push origin main
   ```

### 第二步：部署后端

1. **访问 Render**：https://render.com
2. **注册/登录**（可以使用 GitHub 账号）
3. **创建新的 Web Service**
   - 点击 "New" → "Web Service"
   - 连接你的 GitHub 仓库
   - 选择 `portfolio-backend` 目录

4. **配置后端服务**
   - **Name**: `portfolio-backend`（或自定义）
   - **Environment**: `Node`
   - **Build Command**: `npm install`
   - **Start Command**: `node server.js`
   - **Root Directory**: `portfolio-backend`

5. **设置环境变量**
   - `NODE_ENV`: `production`
   - `PORT`: `10000`（Render 会自动设置，但可以指定）
   - `JWT_SECRET`: 设置一个强密码（用于 JWT 加密）

6. **点击 "Create Web Service"**
   - 等待部署完成
   - 记录下生成的 URL（例如：`https://portfolio-backend.onrender.com`）

### 第三步：部署前端

1. **创建新的 Static Site**
   - 点击 "New" → "Static Site"
   - 连接你的 GitHub 仓库
   - 选择 `portfolio-frontend` 目录

2. **配置前端服务**
   - **Name**: `portfolio-frontend`（或自定义）
   - **Build Command**: `npm install && npm run build`
   - **Publish Directory**: `dist`

3. **设置环境变量**
   - `VITE_API_URL`: 后端服务的 URL（例如：`https://portfolio-backend.onrender.com`）
   - ⚠️ **重要**：不要包含 `/api` 后缀，代码会自动添加

4. **点击 "Create Static Site"**
   - 等待部署完成
   - 记录下生成的 URL（例如：`https://portfolio-frontend.onrender.com`）

### 第四步：配置数据库和文件存储

Render 的免费服务在休眠后会自动唤醒，但需要注意：
- **数据库文件**：SQLite 文件会持久化保存
- **上传文件**：需要配置持久化存储

**重要**：Render 免费服务在 15 分钟无活动后会休眠，首次访问需要几秒唤醒。

---

## 🔒 安全配置

### 1. 修改 JWT Secret
在 Render 的环境变量中设置一个强密码：
```
JWT_SECRET=你的强密码（至少32个字符）
```

### 2. 确保 CORS 配置正确
后端已配置 CORS，允许前端域名访问。

### 3. 后台管理系统安全
- ✅ 使用 JWT Token 认证
- ✅ 密码使用 bcrypt 加密
- ✅ API 路由需要认证
- ✅ Token 24小时过期

---

## 📝 代码已准备就绪

✅ **所有代码已修改完成**：
- 前端已使用环境变量 `VITE_API_URL`
- 后端已支持 `PORT` 环境变量
- 所有图片 URL 已改为使用 `getImageUrl()` 函数
- 支持生产环境和开发环境自动切换

---

## 🔄 更新部署

每次推送代码到 GitHub 后，Render 会自动重新部署。

---

## 💰 费用说明

- **免费额度**：
  - Web Service：750 小时/月（足够个人使用）
  - Static Site：完全免费
  - 带宽：100GB/月

- **如果超出免费额度**：
  - Web Service：$7/月起
  - 建议：只在需要时启动服务

---

## 🆘 常见问题

### 1. 服务休眠
免费服务 15 分钟无活动后会休眠，首次访问需要等待几秒唤醒。

### 2. 文件上传失败
确保 `uploads` 目录有写权限，Render 会自动处理。

### 3. 数据库丢失
SQLite 文件会持久化保存，但建议定期备份。

---

## 📞 其他部署方案

### 方案二：Vercel（前端）+ Railway（后端）
- **前端**：Vercel（免费，部署简单）
- **后端**：Railway（免费额度，支持数据库）

### 方案三：Netlify（前端）+ Fly.io（后端）
- **前端**：Netlify（免费）
- **后端**：Fly.io（免费额度）

---

## ✅ 部署检查清单

- [ ] 代码已推送到 GitHub
- [ ] 后端服务已部署并运行
- [ ] 前端已部署并配置了正确的 API URL
- [ ] 环境变量已设置
- [ ] 测试登录功能
- [ ] 测试文件上传功能
- [ ] 测试前端访问后端 API

---

**部署完成后，你的网站就可以通过公网访问了！** 🎉

